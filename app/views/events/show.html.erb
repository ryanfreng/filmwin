<% provide(:title, @event.name) %>
<div class="jumbotron">
  <% if signed_in? and current_user.events.find_by(id: params[:id]) -%>
  <%= link_to "Edit event", edit_event_path(@event) %>
  <% end -%>
  <h1>
    <%= @event.name %>
  </h1>
  <p class="lead">
    <%= @event.sub_heading %>
  </p>
  <p><%= link_to "Enter now!", new_submission_path(id: @event.id), class: "btn btn-lg btn-success" %></p>
</div>
<div class="row">
  <p class="col-md-8 col-md-offset-2">
    <%= @event.description %>
  </p>
</div>
<div class="row text-center" style="padding: 60px 0;">
  <div class="col-md-3">
    <span style="font-size: 40px;" class="glyphicon glyphicon-ok"></span>
    <h3>Entry Opens</h3> 
    <h4><%= pretty_date(@event.entry_start_date) %></h4>
  </div>
  <div class="col-md-3">
    <span style="font-size: 40px;" class="glyphicon glyphicon-remove"></span>
    <h3>Entry Closes</h3> 
    <h4><%= pretty_date(@event.entry_end_date) %></h4>
  </div>
  <div class="col-md-3">
    <span style="font-size: 40px;" class="glyphicon glyphicon-user"></span>
    <h3>Judging Date</h3> 
    <h4><%= pretty_date(@event.judging_date) %></h4>
  </div>
  <div class="col-md-3">
    <span style="font-size: 40px;" class="glyphicon glyphicon-gift"></span>
    <h3>Awards Show</h3> 
    <h4><%= pretty_date_time(@event.show_date) %></h4>
  </div>
</div>
<div class="container">
<h1>Categories</h1>
<% if can_edit_event? -%>
  <div class="row">
  <div class="col-md-4 col-md-offset-4"><h2>New Category</h2>
  <%= form_for(@new_category) do |c| %>
    <%= render 'categories/fields', c: c, object: c.object, event: @event %>
    <%= c.hidden_field :event_id, value: @event.id %>

    <%= c.submit "Save new category", class: "btn btn-large btn-primary" %>
  <% end %>
  </div>
  </div>
<% end -%>

<div class="row">
  <% @event.parent_categories.sort { |x, y| y.children.count <=> x.children.count }.each do |p| -%>
  <div class="col-md-4">
    <h3><%= link_to("Edit", edit_category_path(p)) if can_edit_event? %> <%= p.name %></h3>
    <p><%= p.description %></p>
    <ul>
    <% p.children.each do |c| -%>
      <li><h4><%= link_to("Edit", edit_category_path(c)) if can_edit_event? %> <%= c.name %></h4><%= c.description %></li>
    <% end -%>
    </ul>
  </div>
  <% end -%>
</div>

  <div class="col-md-6 col-md-offset-3">
    <h1>Top Awards</h1>
    <p>These will be awarded in addition to the category awards.</p>
    <h3>Judges Favorite (3)</h3>
    <p>Each judge picks their favorite piece.</p>
    <h3>Best in Show</h3>
    <p>The piece that stands above the rest.</p>
  </div>
</div>